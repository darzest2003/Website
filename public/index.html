<!doctype html>
<html lang="en">  
<head>  
  <meta charset="utf-8" />  
  <!-- ‚úÖ Security & Privacy Meta Tags -->
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="DENY">
<meta http-equiv="Referrer-Policy" content="no-referrer">
<meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), payment=()">

<!-- ‚úÖ Strong Content Security Policy -->
<meta http-equiv="Content-Security-Policy"
  content="
    default-src 'self' https:;
    script-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com 'unsafe-inline';
    style-src 'self' 'unsafe-inline' https:;
    img-src 'self' https: data:;
    connect-src 'self' https://cppbackened.onrender.com;
    font-src 'self' https: data:;
    object-src 'none';
    frame-ancestors 'none';
    base-uri 'self';
    form-action 'self' https://wa.me;
  ">
  <meta name="viewport" content="width=device-width,initial-scale=1" />  
  <title>ONLINETRADERZ ‚Äî Shop</title>  
  <meta name="description" content="ONLINETRADERZ ‚Äî modern storefront" />    
  <link rel="stylesheet" href="style.css">
</head>  

<body class="theme-grey">  

  <!-- Sidebar Toggle Button (Top Left) -->
<button class="menu-toggle" id="menuToggle">
  ‚ò∞
</button>

<!-- Sidebar Menu -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <h3>Categories</h3>
    <button class="close-sidebar" id="closeSidebar">‚úï</button>
  </div>
  <ul class="category-list">
    <li data-category="car-accessories">Car Accessories</li>
    <li data-category="lights">Lights</li>
    <li data-category="car-cleaner">Car Cleaner</li>
    <li data-category="shirts">Shirts</li>
    <li data-category="winter-collections">Winter Collections</li>
    <li data-category="jewelry-items">Jewelry Items</li>
    <li data-category="body-mists">Body Mists</li>
  </ul>
</aside>
  <header class="site-header">
    <nav class="nav">
      <div class="brand">
        <div class="brand-logo">OZ</div>
        ONLINETRADERZ
      </div>
      <div class="nav-links">
        <a href="#">Home</a>
        <a href="#">Shop</a>
        <a href="#">About</a>
        <a href="#">Contact</a>
      </div>
      <div class="nav-actions">
        <button class="theme-toggle">üåô</button>
        <button class="cart-btn">üõí Cart <span class="cart-count">0</span></button>
      </div>
    </nav>
  </header>

  <main class="page">
    <section class="hero">
      <h1>Welcome to ONLINETRADERZ</h1>
      <p>Shop with elegance.</p>
    </section>

     

    <section class="lock-banner">
      <div class="lock-content">
        <img src="https://cdn-icons-png.flaticon.com/512/3062/3062634.png" alt="Secure Shopping" class="lock-icon">
        <h2>Cash on Delivery Available</h2>
        <p>Shop securely with confidence ‚Äî your orders are safe and delivered right to your doorstep.</p>
        <div class="banner-images">
          <img src="images/Banner1.jpg" alt="Cash on Delivery Banner">
          <img src="images/Banner2.jpg" alt="Truck Delivery Banner">
      <img src="images/Banner3.jpg" alt="Boy Receiving Parcel"> 
        </div>
      </div>
    </section>

    
    
  
    <div class="tools">
      <div class="search">
        <input type="text" placeholder="Search products..." />
      </div>
      <div class="filter">Filter</div>
    </div>

  </main>

  <footer class="footer">
    &copy; 2025 ONLINETRADERZ. All Rights Reserved.
    <br><br>
    <a href="mailto:farisdaar107@gmail.com" class="footer-email" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/561/561127.png" alt="Email Icon">
      farisdaar107@gmail.com
    </a>
  </footer>

  <!-- Floating WhatsApp Button -->
  <a href="https://wa.me/923444318078" class="whatsapp-float" target="_blank" aria-label="Chat on WhatsApp">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" />
    
  </a>

   <!-- üõí Cart Sidebar -->
  <div class="cart-sidebar" id="cartSidebar">
    <div class="cart-header">
      <h3>Your Cart</h3>
      <button id="closeCart">‚úñ</button>
    </div>
    <div id="cartItems"></div>
    <div class="cart-footer">
      <p>Total: Rs.<span id="cartTotal">0</span></p>
      <button class="checkout-btn">Checkout</button>
    </div>
  </div>


<script>
const API_BASE = "https://cppbackened.onrender.com";
let cart = JSON.parse(localStorage.getItem("cart")) || [];

// ----------------- Cart Functions -----------------
function updateCartCount() { document.querySelector(".cart-count").textContent = cart.length; }
function saveCart() { localStorage.setItem("cart", JSON.stringify(cart)); updateCartCount(); renderCartItems(); }
function addToCart(p) { 
    if(p.stock<=0){ alert("Out of stock!"); return; } 
    const e = cart.find(i=>i.id===p.id); 
    if(e){ e.quantity++ } else { p.quantity=1; cart.push(p); } 
    saveCart(); 
    alert(`${p.title} added!`); 
}
function changeQuantity(i,d){ cart[i].quantity+=d; if(cart[i].quantity<=0) cart.splice(i,1); saveCart(); }
function removeFromCart(i){ cart.splice(i,1); saveCart(); }
function renderCartItems(){ 
    const container=document.getElementById("cartItems"); 
    const total=document.getElementById("cartTotal"); 
    container.innerHTML=""; 
    let sum=0; 
    cart.forEach((item,i)=>{ 
        const div=document.createElement("div"); 
        div.className="cart-item"; 
        div.innerHTML=`<img src="${item.img}" alt="${item.title}"><div class="cart-item-details"><h4>${item.title}</h4><p>Rs.${item.price}</p><div class="qty-control"><button onclick="changeQuantity(${i},-1)">‚ûñ</button><span>${item.quantity}</span><button onclick="changeQuantity(${i},1)">‚ûï</button></div></div><button class="remove-btn" onclick="removeFromCart(${i})">üóëÔ∏è</button>`; 
        container.appendChild(div); 
        sum+=item.price*item.quantity; 
    }); 
    total.textContent=sum; 
}

// ----------------- Cart Sidebar -----------------
document.querySelector(".cart-btn").addEventListener("click",()=>document.getElementById("cartSidebar").classList.add("active"));
document.getElementById("closeCart").addEventListener("click",()=>document.getElementById("cartSidebar").classList.remove("active"));
updateCartCount(); renderCartItems();

// ----------------- Load Products -----------------
async function loadProducts(){
  try{
    const res=await fetch(`${API_BASE}/api/products`);
    const products=await res.json();
    displayProducts(products);
  }catch(err){console.error(err);}
}

// ----------------- Display Products -----------------
function displayProducts(products){
  const grid=document.createElement("div"); grid.className="grid";
  products.forEach(p=>{
    const card=document.createElement("div"); card.className="card"; card.setAttribute("data-category",p.category||"all");
    const badgeHTML=p.badge?`<div class="badge ${p.badge}">${p.badge}</div>`:"";
    card.innerHTML=`${badgeHTML}<img src="${p.img}" alt="${p.title}"><h3>${p.title}</h3><div class="meta"><div class="price">Rs.${p.price}</div><div class="stock ${p.stock>0?'in':'out'}">${p.stock>0?'In Stock':'Out of Stock'}</div></div>`;
    grid.appendChild(card);

    // Click opens inline product detail section
    card.addEventListener("click",()=>openProductDetail(p));
  });
  document.querySelector(".page").appendChild(grid);
}

// ----------------- Product Detail View -----------------
// ----------------- Product Detail Overlay -----------------
function openProductDetail(p){
    // Remove any existing overlay
    const existing = document.querySelector(".product-detail-overlay");
    if(existing) existing.remove();

    // Create overlay
    const overlay = document.createElement("div");
    overlay.className = "product-detail-overlay";
    overlay.innerHTML = `
    <div class="product-detail-page">
      <button class="close-detail">‚úñ</button>
      <div class="product-images">
        <img src="${p.img}" alt="${p.title}" class="main-img">
        ${p.gallery ? p.gallery.map(img => `<img src="${img}" class="thumb-img">`).join('') : ''}
      </div>
      <div class="product-info">
        <h2>${p.title}</h2>
        <p class="price">Rs.${p.price}</p>
        <p class="stock">${p.stock>0 ? '‚úÖ In Stock' : '‚ùå Out of Stock'}</p>
        <p class="desc">${p.desc || 'No description available.'}</p>
        <div class="actions">
          <button class="btn add-cart-btn">Add to Cart üõí</button>
          <a href="https://wa.me/923444318078?text=I'm%20interested%20in%20${encodeURIComponent(p.title)}" target="_blank" class="btn whatsapp-btn">WhatsApp üì±</a>
          <button class="btn close-btn">Close</button>
        </div>
        <div class="pro-features">
          <h4>Pro Features:</h4>
          <ul>
            <li>High quality images</li>
            <li>Fast delivery</li>
            <li>Easy returns</li>
            <li>Secure payment options</li>
          </ul>
        </div>
      </div>
    </div>
    `;
    document.body.appendChild(overlay);

    // Event listeners
    overlay.querySelector(".close-detail").addEventListener("click", () => overlay.remove());
    overlay.querySelector(".close-btn").addEventListener("click", () => overlay.remove());
    overlay.querySelector(".add-cart-btn").addEventListener("click", () => addToCart(p));

    // Optional: click thumbnail to change main image
    overlay.querySelectorAll(".thumb-img").forEach(img => {
        img.addEventListener("click", e => {
            overlay.querySelector(".main-img").src = e.target.src;
        });
    });
}

// ----------------- Sidebar & Category Filter -----------------
document.getElementById('menuToggle').addEventListener('click',()=>document.getElementById('sidebar').classList.add('active'));
document.getElementById('closeSidebar').addEventListener('click',()=>document.getElementById('sidebar').classList.remove('active'));
document.querySelectorAll('.category-list li').forEach(item=>item.addEventListener('click',()=>{
    const sel=item.getAttribute('data-category'); 
    document.querySelectorAll('.card').forEach(c=>{
        c.style.display=(sel===c.getAttribute('data-category')||sel==='all')?'flex':'none';
    });
    document.getElementById('sidebar').classList.remove('active');
}));

// ----------------- Search -----------------
document.querySelector('.search input').addEventListener('input',e=>{
    const q=e.target.value.toLowerCase(); 
    document.querySelectorAll('.card').forEach(c=>{
        c.style.display=c.querySelector('h3').textContent.toLowerCase().includes(q)?'flex':'none';
    });
});

// ----------------- Theme Toggle -----------------
document.querySelector('.theme-toggle').addEventListener('click',()=>{ document.body.classList.toggle('theme-dark'); document.body.classList.toggle('theme-grey'); });

// ----------------- Checkout & Payment -----------------
document.querySelector(".cart-footer .checkout-btn").addEventListener("click",()=>{
    if(cart.length===0){ alert("Cart is empty!"); return; }
    const modal=document.createElement("div"); modal.className="checkout-modal-overlay";
    modal.innerHTML=`<div class="checkout-modal" id="checkoutModal">
      <div class="checkout-form">
        <h2>üõí Complete Your Order</h2>
        <form id="orderForm">
          <label>Full Name</label><input type="text" id="custName" required placeholder="John Doe">
          <label>Phone Number</label><input type="tel" id="custContact" required placeholder="03XXXXXXXXX">
          <label>Email (optional)</label><input type="email" id="custEmail" placeholder="example@email.com">
          <label>Delivery Address</label><textarea id="custAddress" required placeholder="House no, street, city"></textarea>
          <label>Payment Method</label>
          <select id="custPayment" required>
            <option value="">Select payment method</option>
            <option value="cod">Cash on Delivery</option>
            <option value="easypaisa">Easypaisa</option>
            <option value="jazzcash">JazzCash</option>
          </select>
          <button type="button" id="submitOrder">Place Order</button>
          <button type="button" id="closeCheckout">Cancel</button>
        </form>
      </div>
    </div>`;
    document.body.appendChild(modal);

    modal.querySelector("#closeCheckout").addEventListener("click",()=>modal.remove());

    modal.querySelector("#submitOrder").addEventListener("click",()=>{
        const name=modal.querySelector("#custName").value.trim();
        const contact=modal.querySelector("#custContact").value.trim();
        const address=modal.querySelector("#custAddress").value.trim();
        const payment=modal.querySelector("#custPayment").value;
        if(!name || !contact || !address || !payment){ alert("Please fill all required fields"); return; }

        const orderId="OZ"+Math.floor(100000 + Math.random()*900000);
        const total=document.getElementById("cartTotal").textContent;
        modal.remove();

        if(payment==="easypaisa"){
            window.open(`https://www.easypaisa.com.pk/pay/03187900076?amount=${total}&reference=${orderId}`,"_blank");
        } else if(payment==="jazzcash"){
            window.open(`https://www.jazzcash.com.pk/pay/03187900076?amount=${total}&reference=${orderId}`,"_blank");
        }

        const popup=document.createElement("div"); popup.className="thank-popup";
        popup.innerHTML=`<div class="thank-card"><h2>üéâ Order Successful!</h2><p>Your order has been placed successfully.</p><p class="redirect-text">Redirecting to home page in <span id="countdown">10</span> seconds...</p></div>`;
        document.body.appendChild(popup);

        let countdown=10;
        const countdownEl=popup.querySelector("#countdown");
        const interval=setInterval(()=>{ countdown--; countdownEl.textContent=countdown; if(countdown<=0) clearInterval(interval); },1000);

        setTimeout(()=>{ popup.remove(); localStorage.removeItem("cart"); window.location.href="index.html"; },10000);
    });
});

// ----------------- Initialize -----------------
loadProducts();
window.addEventListener('beforeunload',saveCart);
          </script>

</body>   
</html>
